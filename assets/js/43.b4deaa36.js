(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{398:function(s,t,a){"use strict";a.r(t);var e=a(42),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"压缩介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#压缩介绍"}},[s._v("#")]),s._v(" 压缩介绍")]),s._v(" "),a("p",[s._v("压缩可以大大减小响应主体的大小，从而提高 "),a("code",[s._v("Web")]),s._v(" 应用程序的速度。")]),s._v(" "),a("p",[s._v("对于生产中的高流量网站，强烈建议从应用程序服务器上卸载压缩功能-通常是在反向代理(例如Nginx)中。在这种情况下，您不应使用压缩中间件。")]),s._v(" "),a("h2",{attrs:{id:"与-express-一起使用-默认"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#与-express-一起使用-默认"}},[s._v("#")]),s._v(" 与 "),a("code",[s._v("Express")]),s._v(" 一起使用(默认)")]),s._v(" "),a("p",[s._v("使用"),a("a",{attrs:{href:"https://github.com/expressjs/compression",target:"_blank",rel:"noopener noreferrer"}},[a("font",{attrs:{color:"red"}},[s._v("压缩")]),a("OutboundLink")],1),s._v("中间件软件包启用 "),a("code",[s._v("gzip")]),s._v(" 压缩。")]),s._v(" "),a("p",[s._v("首先安装所需的软件包：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" i --save compression\n")])])]),a("p",[s._v("安装完成后，将压缩中间件用作全局中间件。")]),s._v(" "),a("div",{staticClass:"language-typescript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" compression "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'compression'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// somewhere in your initialization file")]),s._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("compression")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("h2",{attrs:{id:"与-fastify-一起使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#与-fastify-一起使用"}},[s._v("#")]),s._v(" 与 "),a("code",[s._v("Fastify")]),s._v(" 一起使用")]),s._v(" "),a("p",[s._v("如果使用 "),a("code",[s._v("FastifyAdapter")]),s._v("，则需要使用 "),a("a",{attrs:{href:"https://github.com/fastify/fastify-compress",target:"_blank",rel:"noopener noreferrer"}},[a("font",{attrs:{color:"red"}},[s._v("fastify-compress")]),a("OutboundLink")],1),s._v("：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" i --save fastify-compress\n")])])]),a("p",[s._v("安装完成后，将 "),a("code",[s._v("fastify-compress")]),s._v(" 中间件用作全局中间件。")]),s._v(" "),a("div",{staticClass:"language-typescript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" compression "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fastify-compress'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// somewhere in your initialization file")]),s._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("register")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("compression"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("默认情况下，当浏览器指示支持编码时，"),a("code",[s._v("fastify-compress")]),s._v(" 将使用 "),a("code",[s._v("Brotli")]),s._v(" 压缩(在 "),a("code",[s._v("Node> = 11.7.0上")]),s._v(")。尽管 "),a("code",[s._v("Brotli")]),s._v(" 在压缩率方面非常有效，但它也相当慢。因此，您可能要告诉 "),a("code",[s._v("fastify-compress")]),s._v(" 仅使用 "),a("code",[s._v("deflate")]),s._v(" 和 "),a("code",[s._v("gzip")]),s._v(" 来压缩响应。您最终会得到更大的响应，但也会更快地收到它们。")]),s._v(" "),a("p",[s._v("要指定编码，请为 "),a("code",[s._v("app.register")]),s._v(" 提供第二个参数：")]),s._v(" "),a("div",{staticClass:"language-typescript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[s._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("register")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("compression"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" encodings"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'gzip'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'deflate'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("上面的内容告诉 "),a("code",[s._v("fastify-compress")]),s._v(" 仅使用 "),a("code",[s._v("gzip")]),s._v(" 和 "),a("code",[s._v("deflate")]),s._v(" 编码，如果客户端同时支持 "),a("code",[s._v("gzip")]),s._v(" 和 "),a("code",[s._v("deflate")]),s._v(" 编码，则首选 "),a("code",[s._v("gzip")]),s._v("。")])])}),[],!1,null,null,null);t.default=n.exports}}]);